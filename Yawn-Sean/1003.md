#### [J. Jovial Jaunt](https://codeforces.com/gym/105012/problem/J)

**é¢˜æ„ï¼š** ç»™å‡ºä¸€ä¸ªæœ‰nä¸ªç‚¹çš„æ ‘ï¼Œæ¯ä¸€ä¸ªç‚¹æœ‰ä¸€ä¸ªæƒå€¼ï¼Œå¯¹äºŽå‡½æ•°f(x)æœ‰å¦‚ä¸‹å®šä¹‰

-   $f(x_1) = x_1$.
-   $f(x_1, x_2) = \max{(x_1, x_2)} + \lfloor\sqrt{\min{(x_1, x_2)}}\rfloor$.
-   For $k > 2$, $f(x_1, x_2, \ldots, x_k) = f(f(x_1,\ldots, x_{k-1}), x_k)$.

ä½ å¯ä»¥ä»»æ„é€‰æ‹©èµ·ç‚¹å’Œç»ˆç‚¹ï¼Œé—®æœ€åŽå¯ä»¥å¾—åˆ°çš„ $f(x_1, x_2, ...)$ æœ€å¤§çš„å€¼æ˜¯å¤šå°‘ï¼Ÿ

ðŸ””å¼€å§‹æˆ‘çš„è¯¯åŒºæ˜¯æƒ³ç€æ€Žä¹ˆåˆå¹¶ä¸€ä¸Šä¸€ä¸‹å®žé™…æ ¹æœ¬ä¸ç”¨

å¼€å§‹æˆ‘æƒ³çš„æ˜¯ç»è¿‡valæœ€å¤§çš„é‚£ä¸ªç‚¹ï¼Œç„¶åŽå‘ä¸Šä¸‹ä¸¤è¾¹æ‰©å±•ï¼Œä½†æ˜¯å¹¶ä¸å¯¹ï¼Œå› ä¸ºä¸æ˜¯é€‰äº†æœ€å¤§çš„å°±æ˜¯æœ€å¥½çš„ï¼Œè¿™ç§ç»™å‡ºè·¯å¾„æƒå€¼è¦æ±‚æœ€å¤§åŒ–å€¼çš„é—®é¢˜å°±æ˜¯ç»å…¸æ¢æ ¹dp

é¦–å…ˆé¢„å¤„ç†dfsç»Ÿè®¡dp1[i]ï¼Œè¡¨ç¤ºåœ¨içš„å­æ ‘ä¸­çš„ä»»æ„ä¸€ä¸ªç‚¹å‘ä¸Šèµ°åˆ°iå¯ä»¥å¾—åˆ°çš„æœ€å¤§å€¼ï¼Œæ³¨æ„è¿™é‡Œiæ˜¯æœ€åŽä¸€ä¸ªæ•°å­—ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½å¤Ÿè¿›è¡ŒåŽé¢çš„è½¬ç§»ã€‚ä¹‹åŽç¬¬äºŒæ¬¡dfså¤„ç†å‡ºdp2[i]è¡¨ç¤ºåˆ é™¤ä»¥iä¸ºæ ¹çš„å­æ ‘ä½†æ˜¯ä¿ç•™iåŽï¼Œæ–°çš„æ ¹ä¸ºiçš„ç±»ä¼¼dp1çš„å€¼ï¼Œç±»ä¼¼ä¸€ä¸Šä¸€ä¸‹ã€‚ä½†æ˜¯è¿™é‡Œçš„dp2[i]å¯ä»¥æ¥æºäºŽçˆ¶äº²ä¹Ÿå¯ä»¥æ¥æºäºŽå½“å‰èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è®°å½•ç¬¬ä¸€å¤§çš„å’Œç¬¬äºŒå¤§çš„ï¼Œå½“æˆ‘ä»¬éåŽ†åˆ°ç¬¬ä¸€å¤§çš„å­èŠ‚ç‚¹æ—¶å°±è¦ç”¨åˆ°ç¬¬äºŒå¤§çš„å€¼äº†ã€‚ç„¶åŽå°±åšå‡ºæ¥å•¦

```cpp[]
int f(int x, int y) {
    return max(x, y) + (int)sqrt(min(x, y));
}

void solve(){
    int n;
    cin >> n;
    vector<int> val(n + 1);
    fore(i, 1, n + 1) cin >> val[i];
    vector<vector<int>> p(n + 1);
    int u, v;
    fore(i, 1, n) {
        cin >> u >> v;
        p[u].emplace_back(v);
        p[v].emplace_back(u);
    }
    vector<int> dp1(n + 1), dp2 = dp1;
    auto dfs1 = [&](auto &&dfs1, int s, int fa) -> void
    {
        dp1[s] = val[s];
        for(int to : p[s]) {
            if(to == fa) continue;
            dfs1(dfs1, to, s);
            dp1[s] = max(dp1[s], f(val[s], dp1[to]));
        }
    };
    dfs1(dfs1, 1, -1);
    dp2[1] = val[1];
    auto dfs = [&](auto &&dfs, int s, int fa) -> void
    {
        int first = dp2[s], second = 0;
        for(int to : p[s]) {
            if(to == fa) continue;
            int tmp = f(dp1[to], val[s]);
            if(tmp > first) second = first, first = tmp;
            else if(tmp > second) second = tmp;
        }
        for(int to : p[s]) {
            if(to == fa) continue;
            int tmp = f(dp1[to], val[s]);
            if(tmp == first) dp2[to] = f(second, val[to]);
            else dp2[to] = f(first, val[to]);
            dfs(dfs, to, s);
        }
    };
    dfs(dfs, 1, -1);
    cout << max(*max_element(dp1.begin(), dp1.end()), *max_element(dp2.begin(), dp2.end())) << endl;
}
```
#### [C. Continued Fractions](https://codeforces.com/gym/104854/problem/C)

**é¢˜æ„ï¼š** é¢˜ç›®ç»™å‡ºä¸€ä¸ªå€¼pï¼Œè¦æ±‚æ‰¾åˆ° $10^{18}$ èŒƒå›´å†…æ‰€æœ‰çš„ $a, b$ ï¼Œä½¿å…¶è‡³å°‘æ»¡è¶³ $b | a, (b + 1) | (a + 1), (b + 2) | (a + 2), ...$ æœ€åŽç»“æžœæŒ‰ç…§ä»Žå°åˆ°å¤§è¾“å‡º

è¿™ç§å’Œæ•´é™¤æœ‰å…³é¢˜ç›®è‚¯å®šè¦ç”¨åˆ°åŒ–ç®€çš„ï¼Œè®¾ $a = pb$ æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©

è€Œ $pb+1=(p-1)b+(b+1), pb+2=(p-1)b+(b+2)$ ã€‚(ä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼šå› ä¸ºæˆ‘ä»¬å¸Œæœ›åˆ†å­ä¹Ÿæœ‰ä¸€ä¸ªå’Œ(b + 1)æœ‰å…³çš„å¼å­)

æ‰€ä»¥ $(p-1)b$ æ˜¯ $b+1$ å’Œ $b+2$ çš„å€æ•°ã€‚

è€Œ $(p-1)b\bmod (b+1)=-(p-1), (p-1)b\bmod(b+2)=-2(p-1)$ ã€‚(é€šè¿‡æ•´é™¤å…³ç³»è¿›ä¸€æ­¥åŒ–ç®€)

æ‰€ä»¥è¦æ±‚ $p-1$ æ˜¯ $b+1$ çš„å€æ•°ï¼Œä¸” $2(p-1)$ æ˜¯ $b+2$ çš„å€æ•°ã€‚

å› æ­¤ $2(p-1)$ æ˜¯ $b+1,b+2$ çš„å€æ•°ï¼Œè€Œ $b+1,b+2$ æ˜¯äº’è´¨çš„ï¼Œæ‰€ä»¥ä¹Ÿå°±æ˜¯ $(b+1)(b+2)$ çš„å€æ•°ã€‚ä¸å¦¨è®¾ $2(p-1)=k(b+1)(b+2)$ ã€‚

å› ä¸º $p$ çš„èŒƒå›´æ˜¯ $10^{18}$ ï¼Œæ‰€ä»¥ $k,b+1,b+2$ ä¸­è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ æ˜¯ä¸è¶…è¿‡ $(2\times 10^{18})^{1/3}$ ï¼Œæ‰€ä»¥æžšä¸¾è¿™ä¸ªå…ƒç´ ï¼Œå‰©ä½™å…ƒç´ ä¹Ÿéƒ½æ±‚å‡ºæ¥äº†ï¼Œå†ç¡®è®¤å‰é¢çš„æ¡ä»¶æ˜¯å¦æ»¡è¶³å³å¯ï¼ˆå°±æ˜¯ $p-1$ æ˜¯ $b+1$ çš„å€æ•°ï¼Œä¸” $2(p-1)$ æ˜¯ $b+2$ çš„å€æ•°ï¼‰ã€‚

æ³¨æ„è¿™é‡Œæžšä¸¾çš„æ—¶å€™æ˜¯æœ€å¤š $10^6$ ä½†æ˜¯ç»“æžœå¯ä¸æ˜¯å“¦ï¼Œå¯¹äºŽè¾ƒå¤§çš„bæˆ‘ä»¬è¦æžšä¸¾kè§£æ–¹ç¨‹å¾—åˆ°

æ—¶é—´å¤æ‚åº¦ä¸º $\mathcal{O}(M^{1/3})$ ã€‚

```cpp[]
void solve(){
    int p;
    cin >> p;
    vector<int> ans;
    fore(b, 1, 2000000 + 1) {
        if((p - 1) % (b + 1) == 0 && 2 * (p - 1) % (b + 2) == 0)
            ans.emplace_back(b);
    }
    fore(k, 1, 2000000 + 1) {
        if(2 * (p - 1) % k == 0) {
            int x = 2 * (p - 1) / k;
            int D = 4 * x + 1;
            int sqrtD = sqrtl(D);
            while(sqrtD * sqrtD < D) sqrtD++;
            while(sqrtD * sqrtD > D) sqrtD--;
            int b = (sqrtD - 3) / 2;
            if (b > 0 && (p - 1) % (b + 1) == 0 && 2 * (p - 1) % (b + 2) == 0)
                ans.emplace_back(b);
        }
    }
    sort(ans.begin(), ans.end());
    int k = unique(ans.begin(), ans.end()) - ans.begin();
    cout << k << endl;
    fore(i, 0, k) cout << ans[i] << " \n"[i == k - 1];
}
```

